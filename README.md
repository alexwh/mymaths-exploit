mymaths-exploit: how to use

Step 1: enter school's username and password below, and click SUBMIT
Step 2: enter your personal id code and 3 letter password, and click View
Step 3: select a task from the list
Step 4: the task will open in Internet Explorer, copy and paste the address into the task box
Step 5: click LOAD TASK, and the task will appear. enter whatever score you want for each question, then click SET

exploit details:

MyMaths uses a numeric verification system, in that the final score for question 1 and question 2, the id number of the task, and the authCode (a bit like a temporary access code, but doesn't contain any sensitive information) are used to create the sCode. The sCode is then used by the flash object to submit the scores. The parameters are also passed in the URL, so the server can check that the sCode is valid. A cookie is also used to validate the score.

This program generates the sCode and the URL with all parameters filled in ready for submission. You can figure out this exploit manually using the sCode generator and the following methods:

1. Log in to mymaths.co.uk
2. Go to [http://www.mymaths.co.uk/auth.asp](http://www.mymaths.co.uk/auth.asp) and copy down the 6-digit authCode value. (Ignore the studentID, it is useless)
3. Click Back (this is vital, going back to MyMaths manually will log you out) to get back to the task menu
4. Select a task (not all tasks work, most do, but worksheets don't, as they use POST submission methods that we haven't figured out yet. It might not be possible to recreate these manually)
5. Copy down the taskID in the task address. (example: /loadtask.asp?title=topic/homeworkOH&taskID=XXXX)
6. Launch the sCode generator in mymaths-exploit, enter the authCode, taskID, and what scores you want for each question (probably not a good idea to go above the maximum)
7. Click Generate, and then copy and paste the URL at the bottom into the =SAME WINDOW AS THE TASK=. Then click Go, and you SHOULD get a screen with a load of parameters, hopefully starting with "&percentage=(whatever percentage score you got)" and the parameter "scoresaved" should be 1. If this is the case, it should have worked. Check your results page.

about the program:

The program grabs the authCode once you've logged in (which is why it goes to the task menu twice). It then waits for you to select a task. The task will open in Internet Explorer as a new window. It waits for you to copy and paste the URL of the task into the box and click Load Task (this goes to the task so you can see the max scores and grabs the taskID at the same time). It waits for you to input a score and click SET. The SET button launches the entire exploit, using code that was decompiled from all of the SWF tasks to generate the sCode using MyMaths' own algorithm that was ported over to C# from ActionScript. The sCode is generated, and the URL is formatted using the parameters that you supplied to create the sCode. It then navigates to the URL, which causes the server to save your score. 

Attack vector discovered and worked into a working exploit manually by [alexwh](https://github.com/alexwh), program written by [myself](https://github.com/saint1997).